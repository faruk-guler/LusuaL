# Apt-cacher-ng Kurulumu:



## dark-side VM hazırlama: [iptables]
** Mevcut bağlantının korunması için önce ACCEPT, sonra DROP policy uygulanmalıdır.

# Öncelikle SSH portuna izin ver. (opsiyonel)
sudo iptables -A OUTPUT -p tcp --sport 22 -j ACCEPT (giden)
sudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT (gelen)

# Giden trafiği engelle (internet)
sudo iptables -P OUTPUT DROP

# Gelen trafiği engelle (internet)
sudo iptables -P INPUT DROP

# Yerel ağ (örneğin 192.168.1.0/24) içi trafiğe izin ver:
sudo iptables -A OUTPUT -d 192.168.1.0/24 -j ACCEPT
sudo iptables -A INPUT -s 192.168.1.0/24 -j ACCEPT

# Opsiyonel: Sadece DNS trafiğine izin ver (UDP-TCP)

sudo iptables -A OUTPUT -p udp --dport 53 -j ACCEPT
sudo iptables -A INPUT -p udp --sport 53 -j ACCEPT
sudo iptables -A OUTPUT -p tcp --dport 53 -j ACCEPT
sudo iptables -A INPUT -p tcp --sport 53 -j ACCEPT

# Özel IP'ye izin:
sudo iptables -A OUTPUT -d 192.168.1.10 -j ACCEPT
sudo iptables -A INPUT -s 192.168.1.10 -j ACCEPT

# Loopback (localhost) trafiğine izin ver:
iptables -A INPUT -i lo -j ACCEPT
iptables -A OUTPUT -o lo -j ACCEPT

# Kuralları kalıcı yap-restore et-sil:
sudo apt install iptables-persistent
sudo netfilter-persistent save

sudo iptables-save > /etc/iptables/rules.v4
iptables-restore < /etc/iptables/rules.v4
sudo rm /etc/iptables.rules

# Kuralları listele:
sudo iptables -L -n -v
sudo iptables -S

# Tüm kuralları temizle:
# sudo iptables -F
# sudo iptables -X
# 
